{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u00cdndice","text":"<ol> <li> <p>Trazado de vulnerabiliad: Documentaci\u00f3n sobre el trazado de la vulnerabilidad</p> </li> <li> <p>An\u00e1lisis de vulnerabilidad en m\u00e1quina vulnerable: Documentaci\u00f3n de la explotaci\u00f3n y securizaci\u00f3n de la vulnerabilidad</p> </li> <li> <p>Comprobaci\u00f3n de los requisitos de Seguridad de una aplicaci\u00f3n: Documentaci\u00f3n del an\u00e1lisis de la comprobaci\u00f3n de los requisitos de seguridad </p> </li> <li> <p>Reflexi\u00f3n sobre los riesgos de las aplicaciones: Reflexi\u00f3n sobre los riesgos de las aplicaciones desarrolladas, en funci\u00f3n de sus caracter\u00edsticas </p> </li> </ol> <p>Esta documentaci\u00f3n recoge todas las operaciones realizadas durante el desarrollo de la tarea de la Unidad 2 del m\u00f3dulo Puesta en Producci\u00f3n Segura (PPS).</p>"},{"location":"#contenido-de-la-documentacion","title":"Contenido de la documentaci\u00f3n","text":"Archivo Descripci\u00f3n <code>TrazadoVulnerabilidadGoAnywhere.md</code> Seguimiento de la vulnerabilidad en GoAnywhere MFT de Fortra. <code>analisisVulnerabilidad.md</code> Documentaci\u00f3n y pruebas de ejecuci\u00f3n de c\u00f3digo en m\u00e1quinas vulnerables. <code>ComprobacionRequisitosAplicacion.md</code> An\u00e1lisis de la comprobaci\u00f3n de los requisitos de seguridad en la app lavadero. <code>conclusiones.md</code> Reflexi\u00f3n final sobre los riesgos en las aplicaciones."},{"location":"#software-utilizado","title":"Software utilizado","text":"Software Funci\u00f3n Navegadores Brave y Firefox Documentaci\u00f3n en an\u00e1lisis y trazado de la vulnerabilidad. LibreOffice Calc Documentaci\u00f3n en la comprobaci\u00f3n de requisitos de seguridad de una aplicaci\u00f3n. Docker Ejecuci\u00f3n de entorno de m\u00e1quinas vulnerables. <p>Joaqu\u00edn Bravo Rodr\u00edguez PPS Puesta en Producci\u00f3n Segura IES Valle del Jerte Curso 2025\u20132026</p> <p></p>"},{"location":"ComprobacionRequisitosAplicacion/","title":"3. Comprobaci\u00f3n de los requisitos de seguridad de la aplicaci\u00f3n (OWASP ASVS)","text":"<p>En esta pr\u00e1ctica se ha aplicado el est\u00e1ndar OWASP Application Security Verification Standard (ASVS) con el objetivo de comprobar los requisitos de seguridad de la aplicaci\u00f3n desarrollada en Python durante la unidad anterior.</p> <p>La verificaci\u00f3n se ha centrado en los cap\u00edtulos indicados en la actividad:</p> <ul> <li>Cap\u00edtulo 5: Validaci\u00f3n de entrada</li> <li>Cap\u00edtulo 10: C\u00f3digo malicioso</li> </ul> <p>El an\u00e1lisis se ha realizado mediante revisi\u00f3n manual del c\u00f3digo fuente y apoy\u00e1ndose en herramientas autom\u00e1ticas de an\u00e1lisis est\u00e1tico.</p>"},{"location":"ComprobacionRequisitosAplicacion/#31-descripcion-de-la-aplicacion-y-nivel-de-seguridad-asvs","title":"3.1 Descripci\u00f3n de la aplicaci\u00f3n y nivel de seguridad ASVS","text":"<p>La aplicaci\u00f3n que se analiza es la de la unidad anterior, una aplicaci\u00f3n local de consola desarrollada en Python, cuyo objetivo es simular el funcionamiento de un lavadero autom\u00e1tico.</p> <p>Se trata de una aplicaci\u00f3n sin interfaz web, sin comunicaciones de red y sin acceso a bases de datos. La interacci\u00f3n con el usuario se realiza exclusivamente mediante la introducci\u00f3n de opciones por consola, guiadas por el propio flujo de la aplicaci\u00f3n.</p> <p>Debido a estas caracter\u00edsticas, la aplicaci\u00f3n no est\u00e1 expuesta a Internet ni gestiona informaci\u00f3n sensible, por lo que el nivel de seguridad requerido es ASVS Nivel 1, adecuado para aplicaciones sencillas y de uso local.</p>"},{"location":"ComprobacionRequisitosAplicacion/#32-validacion-de-entrada-input_validation","title":"3.2 Validaci\u00f3n de entrada (Input_Validation)","text":"<p>El cap\u00edtulo de validaci\u00f3n de entrada del est\u00e1ndar ASVS est\u00e1 orientado principalmente a aplicaciones web que procesan datos procedentes de formularios, peticiones HTTP o servicios externos. En el caso de la aplicaci\u00f3n analizada, muchos de los requisitos definidos en este cap\u00edtulo no son aplicables debido a su naturaleza local.</p> <p>La aplicaci\u00f3n no recibe par\u00e1metros GET o POST, no utiliza cookies, cabeceras HTTP ni variables de entorno, y no procesa datos estructurados complejos como HTML, JSON o XML. Tampoco se realizan redirecciones, ni se utilizan plantillas din\u00e1micas o motores de renderizado.</p> <p>Las entradas del usuario se realizan mediante opciones predefinidas mostradas por consola, lo que limita los valores posibles y evita la introducci\u00f3n de datos arbitrarios. Este enfoque permite aplicar validaci\u00f3n positiva (allow lists) de forma impl\u00edcita, ya que el usuario solo puede seleccionar entre las opciones previstas por la l\u00f3gica del programa.</p> <p>Asimismo, la aplicaci\u00f3n no utiliza mecanismos de ejecuci\u00f3n din\u00e1mica de c\u00f3digo como <code>eval()</code>, ni realiza llamadas al sistema operativo basadas en datos introducidos por el usuario. Esto reduce significativamente los riesgos asociados a inyecciones de c\u00f3digo, inyecci\u00f3n de comandos o ejecuci\u00f3n no controlada.</p> <p>En consecuencia, los controles ASVS relacionados con validaci\u00f3n positiva, tipado de datos y prevenci\u00f3n de inyecciones se consideran cumplidos, mientras que aquellos orientados a entornos web o a la sanitizaci\u00f3n de formatos complejos se consideran no aplicables.</p> <p></p>"},{"location":"ComprobacionRequisitosAplicacion/#33-codigo-malicioso-malicious_code","title":"3.3 C\u00f3digo malicioso (Malicious_code)","text":"<p>Para la comprobaci\u00f3n de los requisitos relacionados con la detecci\u00f3n de c\u00f3digo malicioso se ha utilizado una herramienta de an\u00e1lisis est\u00e1tico de seguridad espec\u00edfica para aplicaciones Python.</p> <p>La herramienta empleada ha sido Bandit, desarrollada por OpenStack, que permite identificar patrones de c\u00f3digo potencialmente peligrosos, como el uso inseguro de funciones del sistema, ejecuci\u00f3n din\u00e1mica de c\u00f3digo, l\u00f3gica maliciosa, puertas traseras o funcionalidades ocultas.</p> <p>Se ha ejecutado Bandit sobre los archivos principales de la aplicaci\u00f3n (<code>main_app.py</code> y <code>lavadero.py</code>), no detect\u00e1ndose ning\u00fan problema de seguridad ni indicios de c\u00f3digo malicioso.</p> <p>Este resultado permite verificar el cumplimiento de los controles ASVS relacionados con:</p> <ul> <li>El uso de herramientas de an\u00e1lisis de c\u00f3digo.</li> <li>La ausencia de puertas traseras o cuentas embebidas.</li> <li>La inexistencia de l\u00f3gica maliciosa o bombas de c\u00f3digo.</li> <li>La ausencia de funcionalidades ocultas o no documentadas.</li> <li>El uso seguro de funciones del sistema y del lenguaje.</li> </ul> <p></p>"},{"location":"ComprobacionRequisitosAplicacion/#34-uso-de-herramientas-automaticas-de-analisis","title":"3.4 Uso de herramientas autom\u00e1ticas de an\u00e1lisis","text":"<p>Adem\u00e1s de la revisi\u00f3n manual del c\u00f3digo fuente, se ha utilizado una herramienta autom\u00e1tica para apoyar la verificaci\u00f3n de los requisitos ASVS.</p> <p>Bandit ha permitido comprobar de forma objetiva y automatizada varios controles relacionados con c\u00f3digo malicioso y ejecuci\u00f3n insegura, reforzando los resultados obtenidos durante el an\u00e1lisis manual.</p> <p>El uso de este tipo de herramientas facilita la detecci\u00f3n temprana de problemas de seguridad y complementa la revisi\u00f3n manual del c\u00f3digo, especialmente en aplicaciones desarrolladas en Python.</p> <p></p>"},{"location":"ComprobacionRequisitosAplicacion/#35-analisis-del-grado-de-cobertura-asvs","title":"3.5 An\u00e1lisis del grado de cobertura ASVS","text":"<p>El gr\u00e1fico de cobertura incluido en la hoja de c\u00e1lculo OWASP ASVS checklist muestra un n\u00famero elevado de controles marcados como Not Applicable. Este resultado es coherente con el tipo de aplicaci\u00f3n analizada.</p> <p>El est\u00e1ndar ASVS est\u00e1 dise\u00f1ado principalmente para aplicaciones web con mayor complejidad y exposici\u00f3n, por lo que muchos de sus controles no aplican a aplicaciones locales sencillas como la analizada.</p> <p>Los controles aplicables han sido verificados correctamente, obteni\u00e9ndose una cobertura adecuada para el nivel de seguridad requerido.</p> <p></p> <p>ASVS-Checklist-Joaquin.ods</p>"},{"location":"ComprobacionRequisitosAplicacion/#36-valoracion-del-estandar-owasp-asvs","title":"3.6 Valoraci\u00f3n del est\u00e1ndar OWASP ASVS","text":"<p>OWASP ASVS es un est\u00e1ndar muy completo que permite estructurar y documentar la verificaci\u00f3n de seguridad de una aplicaci\u00f3n de forma sistem\u00e1tica.</p> <p>Aunque puede resultar extenso para aplicaciones peque\u00f1as o locales, facilita la identificaci\u00f3n de los requisitos realmente aplicables y permite justificar de forma clara aquellos que no lo son.</p> <p>Su aplicaci\u00f3n contribuye a mejorar la comprensi\u00f3n de los requisitos de seguridad y proporciona una base s\u00f3lida para el desarrollo de aplicaciones m\u00e1s seguras.</p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/","title":"1. Documentaci\u00f3n sobre el trazado de la vulnerabilidad","text":"<p>En esta documentaci\u00f3n se realiza el trazado completo de una vulnerabilidad, navegando por las distintas listas y organismos oficiales de ciberseguridad. As\u00ed pues, se trata de:  </p> <ul> <li>Conocer las principales listas de informaci\u00f3n sobre ciberseguridad (CVE, NVD, CWE, CAPEC, etc.).</li> <li>Aprender a realizar el trazado de una vulnerabilidad desde una fuente informativa inicial hasta sus patrones de ataque.</li> <li>Analizar el impacto, criticidad y debilidades asociadas a una vulnerabilidad real.</li> </ul> <p>Vulnerabilidad analizada</p> <ul> <li>Producto afectado: GoAnywhere MFT  </li> <li>Fabricante: Fortra  </li> <li>Tipo: Omisi\u00f3n de autenticaci\u00f3n  </li> <li>Gravedad: Cr\u00edtica</li> </ul> <p>La vulnerabilidad permite a un atacante no autenticado acceder a funcionalidades internas de la aplicaci\u00f3n.</p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#11-inicio-del-trazado-incibe","title":"1.1 Inicio del trazado (INCIBE)","text":"<p>El trazado comienza a partir de un art\u00edculo publicado por INCIBE, donde se informa de una vulnerabilidad cr\u00edtica que afecta a GoAnywhere MFT. En dicho art\u00edculo se describe de forma general el problema y se proporcionan referencias externas para ampliar la informaci\u00f3n.</p> <p> </p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#12-web-oficial-del-fabricante-fortra","title":"1.2 Web oficial del fabricante (Fortra)","text":"<p>Desde el art\u00edculo de INCIBE se accede a la web oficial del fabricante, donde se publica el aviso de seguridad correspondiente.</p> <p>En esta p\u00e1gina se detallan:</p> <ul> <li>La descripci\u00f3n t\u00e9cnica de la vulnerabilidad  </li> <li>Las versiones afectadas  </li> <li>Las medidas de mitigaci\u00f3n y parches disponibles  </li> </ul> <p> </p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#13-identificacion-del-cve-y-analisis","title":"1.3 Identificaci\u00f3n del CVE y an\u00e1lisis","text":"<p>En la informaci\u00f3n proporcionada por el fabricante se identifica el identificador CVE asignado a la vulnerabilidad. Este identificador permite realizar el seguimiento oficial del fallo de seguridad en las diferentes bases de datos. Accedemos a la p\u00e1gina oficial de cve.org, donde se muestra la informaci\u00f3n b\u00e1sica del CVE:</p> <ul> <li>Descripci\u00f3n de la vulnerabilidad  </li> <li>Referencias oficiales  </li> <li>Fecha de publicaci\u00f3n  </li> </ul> <p> </p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#14-consulta-en-la-nvd-nist","title":"1.4 Consulta en la NVD (NIST)","text":"<p>A continuaci\u00f3n se consulta la National Vulnerability Database (NVD) mantenida por el NIST, donde se ampl\u00eda la informaci\u00f3n t\u00e9cnica.</p> <p></p> <p>En la NVD se muestra la puntuaci\u00f3n CVSS, que indica el nivel de riesgo de la vulnerabilidad.</p> <ul> <li>Puntuaci\u00f3n CVSS: 9.8 Cr\u00edtica  </li> <li>Vector CVSS: Permite analizar los factores utilizados para calcular la puntuaci\u00f3n  </li> </ul> <p></p> <p>Tambi\u00e9n podemos ver las versiones de softwate a las que afecta:  </p> <p> </p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#15-analisis-de-la-cwe","title":"1.5 An\u00e1lisis de la CWE","text":"<p>Desde la NVD se identifican las debilidades (CWE) explotadas por la vulnerabilidad. Accedemos a la p\u00e1gina oficial de cwe.mitre.org para analizar en detalle la debilidad principal. En esta secci\u00f3n se describe:  </p> <ul> <li>En qu\u00e9 consiste la debilidad  </li> <li>Lenguajes y tecnolog\u00edas afectadas  </li> <li>Posibles mitigaciones  </li> </ul> <p></p> <p>Se observa la relaci\u00f3n de la debilidad con otras CWE, mostrando jerarqu\u00edas de debilidades padre e hijas.</p> <p></p> <p>Tambi\u00e9n una lista de CVE relacionadas.</p> <p></p> <p>Patrones de ataque (CAPEC) Desde la informaci\u00f3n de la CWE se accede a los patrones de ataque (CAPEC) que pueden explotar esta debilidad.  </p> <p></p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#16-analisis-del-patron-de-ataque-capec","title":"1.6 An\u00e1lisis del patr\u00f3n de ataque CAPEC","text":"<p>En la web oficial de capec.mitre.org se analiza el patr\u00f3n de ataque identificado. Se detallan:  </p> <ul> <li>Descripci\u00f3n del ataque  </li> <li>Flujo de ejecuci\u00f3n  </li> <li>Requisitos previos  </li> <li>Consecuencias  </li> <li>Posibles mitigaciones  </li> </ul> <p></p>"},{"location":"TrazadoVulnerabilidadGoAnywhere/#17-descarga-del-registro-cve-en-formato-json","title":"1.7 Descarga del registro CVE en formato JSON","text":"<p>Finalmente, desde cve.org se accede al registro CVE en formato JSON, utilizado para el tratamiento automatizado de la informaci\u00f3n de vulnerabilidades. Este registro contiene informaci\u00f3n estructurada sobre:  </p> <ul> <li>CVE  </li> <li>CWE  </li> <li>CPE  </li> <li>CAPEC  </li> <li>Referencias oficiales</li> </ul> <p>CVE-2024-0204.json</p>"},{"location":"analisisVulnerabilidad/","title":"2. Documentaci\u00f3n de la explotaci\u00f3n y securizaci\u00f3n de la vulnerabilidad","text":"<p>En esta pr\u00e1ctica se ha trabajado con un entorno de m\u00e1quinas vulnerables y se ha realizado un test de intrusi\u00f3n explotando una vulnerabilidad de SQL Injection en la aplicaci\u00f3n bWAPP. En esta documentaci\u00f3n se proponen los siguientes objetivos:  </p> <ul> <li>Conocer distintos proyectos de m\u00e1quinas vulnerables para pr\u00e1cticas de seguridad.  </li> <li>Utilizar un entorno controlado para la realizaci\u00f3n de pruebas de intrusi\u00f3n.  </li> <li>Identificar y explotar una vulnerabilidad de tipo SQL Injection.  </li> <li>Analizar el c\u00f3digo fuente responsable de la vulnerabilidad.</li> </ul> <p>Para la realizaci\u00f3n de esta actividad se han puesto en marcha varios contenedores con docker que forman un entorno de pruebas con aplicaciones web vulnerables.</p>"},{"location":"analisisVulnerabilidad/#21-dvwa-damn-vulnerable-web-application","title":"2.1 DVWA (Damn Vulnerable Web Application)","text":"<p>DVWA es una aplicaci\u00f3n web deliberadamente vulnerable que permite practicar distintos tipos de ataques web, como inyecci\u00f3n SQL, XSS, CSRF, entre otros. Se accede a trav\u00e9s del navegador y permite configurar distintos niveles de seguridad.  </p> <p>Acceso: </p> <ul> <li>URL: http://localhost:8002</li> <li>Usuario: admin</li> <li>Contrase\u00f1a: password</li> </ul> <p>En el primer acceso es necesario crear la base de datos antes de poder comenzar con las pruebas.</p> <p> </p>"},{"location":"analisisVulnerabilidad/#22-owasp-multillidae-ii","title":"2.2 OWASP Multillidae II","text":"<p>OWASP Multillidae II es otra aplicaci\u00f3n web vulnerable mantenida por OWASP que permite entrenar en distintos escenarios de ataque.  </p> <p>Acceso: </p> <ul> <li>URL: http://localhost  </li> <li>PhpMyAdmin: http://localhost:81  </li> <li>PhpLdapAdmin: http://localhost:82  </li> </ul> <p>No es necesario usuario ni contrase\u00f1a para acceder a la aplicaci\u00f3n principal. Incluye servicios adicionales como acceso a bases de datos y servicios LDAP.  </p> <p> </p>"},{"location":"analisisVulnerabilidad/#23-kali-linux","title":"2.3 Kali Linux","text":"<p>Kali Linux se incluye como m\u00e1quina de apoyo para la realizaci\u00f3n de pruebas de seguridad, utilizando herramientas de an\u00e1lisis y test de intrusi\u00f3n sobre el resto de aplicaciones.</p> <p>Acceso: </p> <ul> <li>Kali Linux se utiliza como m\u00e1quina de apoyo para realizar pruebas de seguridad sobre el resto de aplicaciones.  </li> <li>El acceso se realiza mediante terminal, utilizando herramientas de an\u00e1lisis y test de intrusi\u00f3n.</li> </ul> <pre><code>docker exec -it kali /bin/bash\n</code></pre> <p></p>"},{"location":"analisisVulnerabilidad/#24-bwapp-buggy-web-application","title":"2.4 bWAPP (Buggy Web Application)","text":"<p>bWAPP es una aplicaci\u00f3n web vulnerable que contiene m\u00e1s de 100 vulnerabilidades diferentes, orientadas al aprendizaje de seguridad web. Incluye vulnerabilidades de inyecci\u00f3n, autenticaci\u00f3n, gesti\u00f3n de sesiones y validaci\u00f3n de entradas, entre otras.  </p> <p>Acceso: </p> <ul> <li>URL: http://localhost:8001</li> <li>Usuario: bee</li> <li>Contrase\u00f1a: bug</li> </ul> <p>En el primer acceso es necesario crear la base de datos desde la p\u00e1gina de instalaci\u00f3n antes de poder acceder a la aplicaci\u00f3n.</p> <p> </p>"},{"location":"analisisVulnerabilidad/#25-sql-injection-getsearch-en-bwapp-desde-el-punto-de-vista-atacante","title":"2.5 SQL Injection (GET/Search) en bWAPP desde el punto de vista atacante","text":"<p>La p\u00e1gina potencialmente vulnerable esta formada por una tabla y un campo de b\u00fasqueda. Si se realiza una b\u00fasqueda vac\u00eda, la aplicaci\u00f3n lista unas pel\u00edculas:  </p> <p></p>"},{"location":"analisisVulnerabilidad/#251-identificacion-de-la-vulnerabilidad","title":"2.5.1 Identificaci\u00f3n de la vulnerabilidad","text":"<p>Se detecta que el par\u00e1metro <code>title</code> en <code>sqli_1.php</code> es vulnerable a SQL Injection al introducir una comilla simple (<code>'</code>), lo que rompe la consulta original.  </p> <p></p>"},{"location":"analisisVulnerabilidad/#252-determinacion-de-columnas-metodo-de-tanteo","title":"2.5.2 Determinaci\u00f3n de columnas (M\u00e9todo de Tanteo)","text":"<p>Se emplea el m\u00e9todo de incremento manual con <code>UNION SELECT</code>, voy probando consultas incrementando el n\u00famero de constantes (<code>1</code>, <code>1,2</code>, <code>1,2,3</code>...) hasta que la p\u00e1gina carga correctamente.  </p> <p></p> <p>Al llegar a <code>' union select 1,2,3,4,5,6,7-- -</code>, el error desapareci\u00f3, confirmando que la tabla tiene 7 columnas.  </p> <p></p>"},{"location":"analisisVulnerabilidad/#253-mapeo-de-campos-visibles","title":"2.5.3 Mapeo de campos visibles","text":"<p>Al renderizarse la p\u00e1gina con los n\u00fameros del 1 al 7, se identific\u00f3 que solo cuatro columnas son visibles en el HTML:  </p> <ul> <li>Columna 2: Title  </li> <li>Columna 3: Release  </li> <li>Columna 4: Genre  </li> <li>Columna 5: Character</li> </ul> <p></p>"},{"location":"analisisVulnerabilidad/#254-exfiltracion-de-datos","title":"2.5.4  Exfiltraci\u00f3n de datos","text":"<p>Puedo obtener el nombre de la base de datos, sustituyendo el marcador de las comlunmas por funciones como <code>database()</code>, <code>user()</code>, <code>version()</code>,...:</p> <p> </p> <p>Saco las tablas de aplicaci\u00f3n con:  </p> <p><code>' union select 1,database(),user(),table_name,version(),6,7 from information_schema.tables where table_schema=database() -- -</code>.</p> <p></p>"},{"location":"analisisVulnerabilidad/#255-sacar-mas-informacion-contrasenas-de-usuarios","title":"2.5.5  Sacar m\u00e1s informaci\u00f3n, contrase\u00f1as de usuarios","text":"<p>Voy a por la tabla usuarios, ya que se pueden conseguir usuarios y contrase\u00f1as...:</p> <p><code>' union select 1,column_name,3,4,5,6,7 from information_schema.columns where table_name='users' and table_schema=database() -- -</code>.</p> <p></p> <p>Extraigo las claves de usuario con <code>' union select 1,login,password,email,secret,6,7 from users where password&lt;&gt;''-'</code>.</p> <p></p> <p>Copio el hash de la clave y lo identifico en https://duckduckgo.com/.</p> <p></p> <p>Por \u00faltimo, uso un descifrador online sha1: https://sha1.gromweb.com/, la clave de ambos usuarios es bug.</p> <p></p>"},{"location":"analisisVulnerabilidad/#26-sql-injection-getsearch-en-bwapp-desde-el-punto-de-vista-defensivo","title":"2.6 SQL Injection (GET/Search) en bWAPP desde el punto de vista defensivo","text":"<p>En este apartado se realiza un an\u00e1lisis del c\u00f3digo vulnerable a SQL Injection desde el punto de vista defensivo, inspeccionando c\u00f3mo la aplicaci\u00f3n trata el input del usuario dependiendo del nivel de seguridad configurado en bWAPP.</p>"},{"location":"analisisVulnerabilidad/#261-descripcion-de-la-funcionalidad","title":"2.6.1 Descripci\u00f3n de la funcionalidad","text":"<p>La funcionalidad analizada corresponde a la b\u00fasqueda de pel\u00edculas mediante un formulario que env\u00eda el par\u00e1metro <code>title</code> por m\u00e9todo GET.</p> <p></p>"},{"location":"analisisVulnerabilidad/#262-identificacion-del-archivo-vulnerable","title":"2.6.2 Identificaci\u00f3n del archivo vulnerable","text":"<p>El archivo que implementa esta funcionalidad es: <code>/var/www/html/sqli_1.php</code></p> <p>Este archivo recibe el valor introducido por el usuario y lo utiliza para construir una consulta SQL.</p> <p></p>"},{"location":"analisisVulnerabilidad/#263-inspeccion-del-codigo-fuente","title":"2.6.3 Inspecci\u00f3n del c\u00f3digo fuente","text":"<p>Accedemos al contenedor bWAPP y mostramos el contenido del archivo con numeraci\u00f3n de l\u00edneas para facilitar su an\u00e1lisis:</p> <pre><code>docker exec -it bwapp /bin/bash\ncat -n /var/www/html/sqli_1.php\n</code></pre> <p></p>"},{"location":"analisisVulnerabilidad/#264-analisis-del-tratamiento-del-input","title":"2.6.4 An\u00e1lisis del tratamiento del input","text":"<p>En el archivo sqli_1.php se encuentra el siguiente fragmento de c\u00f3digo:</p> <pre><code>$title = $_GET[\"title\"];\n$sql = \"SELECT * FROM movies WHERE title LIKE '%$title%'\";\n</code></pre> <p></p> <p>El valor introducido por el usuario se concatena directamente dentro de la consulta SQL, lo que implica que el input pasa a formar parte de la estructura de la consulta sin validaci\u00f3n previa.</p>"},{"location":"analisisVulnerabilidad/#265-funciones-de-filtrado-segun-el-nivel-de-seguridad","title":"2.6.5 Funciones de filtrado seg\u00fan el nivel de seguridad","text":"<p>El tratamiento del input depende del valor de la cookie security_level. Las funciones encargadas del filtrado se encuentran definidas en el archivo:</p> <pre><code>/var/www/html/functions_external.php\n</code></pre> <p></p>"},{"location":"analisisVulnerabilidad/#266-nivel-de-seguridad-0-vulnerable","title":"2.6.6 Nivel de seguridad 0 \u2013 Vulnerable","text":"<p>Funci\u00f3n no_check() </p> <pre><code>function no_check($data)\n{\n    return $data;\n}\n</code></pre> <p></p> <p>En este nivel, la funci\u00f3n devuelve directamente el input del usuario sin aplicar ning\u00fan tipo de validaci\u00f3n, filtrado ni escape de caracteres especiales. Como consecuencia, caracteres como la comilla simple (') se interpretan como parte de la sintaxis SQL, permitiendo modificar la consulta original. Esto provoca que la aplicaci\u00f3n sea completamente vulnerable a ataques de SQL Injection.  </p>"},{"location":"analisisVulnerabilidad/#267-nivel-de-seguridad-1-proteccion-debil","title":"2.6.7 Nivel de seguridad 1 \u2013 Protecci\u00f3n d\u00e9bil","text":"<p>Funci\u00f3n sqli_check_1() </p> <pre><code>function sqli_check_1($data)\n{\n    return addslashes($data);\n}\n</code></pre> <p></p> <p>En este nivel se utiliza la funci\u00f3n addslashes(), que a\u00f1ade barras invertidas delante de caracteres especiales como:</p> <ul> <li>comilla simple (')  </li> <li>comilla doble (\")  </li> <li>barra invertida ()  </li> </ul> <p>Este filtrado dificulta ataques b\u00e1sicos de SQL Injection, ya que evita que las comillas rompan directamente la consulta SQL. No obstante, este m\u00e9todo no es seguro frente a todos los escenarios y no se considera una protecci\u00f3n adecuada en aplicaciones reales.  </p>"},{"location":"analisisVulnerabilidad/#268-nivel-de-seguridad-2-proteccion-intermedia","title":"2.6.8 Nivel de seguridad 2 \u2013 Protecci\u00f3n intermedia","text":"<p>Funci\u00f3n sqli_check_2() </p> <pre><code>function sqli_check_2($data)\n{\n    return mysql_real_escape_string($data);\n}\n</code></pre> <p></p> <p>En este nivel se emplea la funci\u00f3n mysql_real_escape_string(), que escapa los caracteres especiales teniendo en cuenta el contexto de la base de datos MySQL. Este enfoque ofrece una protecci\u00f3n superior a addslashes(), aunque presenta las siguientes limitaciones:  </p> <ul> <li>Depende de la extensi\u00f3n mysql, actualmente obsoleta</li> <li>No utiliza consultas preparadas  </li> <li>La consulta SQL sigue construy\u00e9ndose mediante concatenaci\u00f3n</li> </ul>"},{"location":"analisisVulnerabilidad/#269-nivel-de-seguridad-3-proteccion-mas-robusta","title":"2.6.9 Nivel de seguridad 3 \u2013 Protecci\u00f3n m\u00e1s robusta","text":"<p>Funci\u00f3n sqli_check_3()</p> <pre><code>function sqli_check_3($link, $data)\n{\n    return mysqli_real_escape_string($link, $data);\n}\n</code></pre> <p></p> <p>En este nivel se utiliza mysqli_real_escape_string(), que escapa correctamente los caracteres especiales utilizando una conexi\u00f3n activa a la base de datos. Este m\u00e9todo ofrece una protecci\u00f3n m\u00e1s robusta frente a ataques de SQL Injection que los niveles anteriores, aunque la consulta sigue siendo construida din\u00e1micamente.   </p>"},{"location":"analisisVulnerabilidad/#2610-nivel-de-seguridad-4-proteccion-adicional","title":"2.6.10 Nivel de seguridad 4 \u2013 Protecci\u00f3n adicional","text":"<p>Funci\u00f3n sqli_check_4()</p> <pre><code>function sqli_check_4($data)\n{\n    $input = str_replace(\"'\", \"''\", $data);\n    return $input;\n}\n</code></pre> <p></p> <p>En este nivel se realiza un reemplazo manual de las comillas simples, duplic\u00e1ndolas para evitar que alteren la sintaxis SQL. Tal y como indica el propio comentario del c\u00f3digo (Not bulletproof), este m\u00e9todo no ofrece una protecci\u00f3n completa y puede ser insuficiente frente a ataques m\u00e1s avanzados.  </p>"},{"location":"analisisVulnerabilidad/#2611-conclusion-y-enlaces-a-archivos-analizados","title":"2.6.11 Conclusi\u00f3n y enlaces a archivos analizados","text":"<p>El an\u00e1lisis del c\u00f3digo muestra c\u00f3mo bWAPP implementa distintos mecanismos de filtrado del input en funci\u00f3n del nivel de seguridad configurado. A medida que aumenta el nivel de seguridad, se aplican t\u00e9cnicas m\u00e1s robustas para escapar caracteres especiales. Sin embargo, en todos los casos la consulta SQL se construye din\u00e1micamente, por lo que la medida m\u00e1s segura frente a SQL Injection ser\u00eda el uso de consultas preparadas (prepared statements).  </p> <p>sqli_1.php</p> <p>sqli_1.php</p> <p>functions_external.php</p> <p>functions_external.php</p>"},{"location":"conclusiones/","title":"4. Reflexi\u00f3n sobre los riesgos de las aplicaciones","text":"<p>La aplicaci\u00f3n desarrollada y analizada en los apartados anteriores es una aplicaci\u00f3n local de consola, con una funcionalidad concreta y un alcance bastante limitado. Desde el punto de vista de la seguridad, este tipo de aplicaciones presentan unos riesgos claramente inferiores a los de aplicaciones m\u00e1s complejas o expuestas a Internet.</p> <p>Al tratarse de una aplicaci\u00f3n local, que no realiza comunicaciones de red ni intercambia informaci\u00f3n con otros sistemas, la superficie de ataque es muy reducida. No existen muchos de los riesgos habituales en aplicaciones web, como inyecciones SQL, ataques XSS, CSRF o accesos no autorizados desde el exterior. En este sentido, la mayor\u00eda de los posibles problemas de seguridad estar\u00edan relacionados con errores de programaci\u00f3n o fallos en la l\u00f3gica de la propia aplicaci\u00f3n.</p> <p>Durante el desarrollo y an\u00e1lisis de la aplicaci\u00f3n, se observa que las entradas del usuario est\u00e1n bastante controladas, ya que se realizan mediante opciones concretas mostradas por consola. Esto limita mucho las posibilidades de introducir datos maliciosos o inesperados. Aun as\u00ed, este tipo de aplicaciones no est\u00e1n completamente libres de riesgos. Una validaci\u00f3n incorrecta o un mal control del flujo del programa podr\u00eda provocar comportamientos no deseados, bloqueos o resultados incorrectos.</p> <p>En un entorno local, el impacto de este tipo de fallos suele ser reducido y normalmente afecta \u00fanicamente al propio usuario o al sistema donde se ejecuta la aplicaci\u00f3n. Sin embargo, esta pr\u00e1ctica ayuda a entender que incluso en aplicaciones sencillas es importante tener en cuenta aspectos b\u00e1sicos de seguridad desde el desarrollo.</p> <p>Si se comparan estos riesgos con los de otros tipos de aplicaciones, las diferencias son evidentes. Por ejemplo, una aplicaci\u00f3n bancaria suele estar expuesta a Internet y gestiona informaci\u00f3n extremadamente sensible, como datos financieros y credenciales de acceso. En este caso, una vulnerabilidad puede tener consecuencias muy graves, como p\u00e9rdidas econ\u00f3micas, fraudes o accesos no autorizados a cuentas de usuario.</p> <p>En aplicaciones del \u00e1mbito de la salud, los riesgos son todav\u00eda m\u00e1s cr\u00edticos. Estas aplicaciones manejan datos m\u00e9dicos personales, por lo que un fallo de seguridad puede afectar directamente a la privacidad de los pacientes e incluso tener consecuencias legales importantes. Adem\u00e1s, en este tipo de aplicaciones la disponibilidad de la informaci\u00f3n es fundamental, ya que un error podr\u00eda impedir el acceso a datos necesarios para la atenci\u00f3n sanitaria.</p> <p>Por otro lado, las aplicaciones de redes sociales presentan riesgos diferentes, relacionados principalmente con la privacidad, la suplantaci\u00f3n de identidad y el uso indebido de la informaci\u00f3n personal de los usuarios. Al contar con una gran cantidad de usuarios y datos, cualquier vulnerabilidad puede tener un impacto muy amplio.</p> <p>Comparando todos estos casos, queda claro que los riesgos de una aplicaci\u00f3n dependen en gran medida de sus caracter\u00edsticas, su exposici\u00f3n y el tipo de informaci\u00f3n que gestiona. La aplicaci\u00f3n desarrollada en esta pr\u00e1ctica tiene un perfil de riesgo bajo, pero sirve como ejemplo para comprender c\u00f3mo deben analizarse los riesgos en funci\u00f3n del contexto.</p> <p>En este sentido, el uso de est\u00e1ndares como OWASP ASVS resulta muy \u00fatil, ya que permite adaptar los requisitos de seguridad al tipo de aplicaci\u00f3n que se est\u00e1 desarrollando. No todas las aplicaciones necesitan el mismo nivel de protecci\u00f3n, pero todas deber\u00edan aplicar medidas de seguridad acordes a los riesgos que presentan.</p> <p>Esta reflexi\u00f3n me ha permitido entender mejor que la seguridad no es un conjunto de reglas fijas que se aplican igual a todos los proyectos, sino un aspecto que debe evaluarse de forma realista en funci\u00f3n del tipo de aplicaci\u00f3n y su uso.</p> <p></p>"}]}